"use strict";exports.id=24,exports.ids=[24],exports.modules={58053:(e,r,s)=>{s.d(r,{z:()=>l});var t=s(97247),a=s(28964),i=s(69008),n=s(77247),o=s(25008);let d=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef(({className:e,variant:r,size:s,asChild:a=!1,...n},l)=>{let c=a?i.g7:"button";return t.jsx(c,{className:(0,o.cn)(d({variant:r,size:s,className:e})),ref:l,...n})});l.displayName="Button"},6352:(e,r,s)=>{s.d(r,{I8:()=>f,w7:()=>g,zB:()=>y});var t=s(35936),a=s(40461),i=s(54068),n=s(68897),o=s(35472),d=s(79306),l=s(39558),c=s(53020),u=s(58995);let m={pages:{signIn:"/sign-in",error:"/sign-in"},session:{strategy:"jwt",maxAge:2592e3},adapter:(0,t.J)(d.Z),providers:[(0,o.Z)({credentials:{email:{type:"email"},password:{type:"password"}},async authorize(e){if(null==e)return null;let r=await d.Z.query.users.findFirst({where:(0,i.eq)(l.users.email,e.email)});return r&&r.password&&(0,a.oH)(e.password,r.password)?{id:r.id,name:r.name,email:r.email,role:r.role}:null}})],callbacks:{jwt:async({token:e,user:r,trigger:s,session:t})=>{if(r&&("signIn"===s||"signUp"===s)){let e=c.cookies().get("sessionCartId")?.value;if(!e)throw Error("Session Cart Not Found");let s=await d.Z.query.carts.findFirst({where:(0,i.eq)(l.carts.sessionCartId,e)});if(s&&!s.userId){let t=await d.Z.query.carts.findFirst({where:(0,i.eq)(l.carts.userId,r.id)});t?((0,c.cookies)().set("beforeSigninSessionCartId",e),(0,c.cookies)().set("sessionCartId",t.sessionCartId)):d.Z.update(l.carts).set({userId:r.id}).where((0,i.eq)(l.carts.id,s.id))}}return t?.user.name&&"update"===s&&(e.name=t.user.name),e},session:async({session:e,user:r,trigger:s,token:t})=>(e.user.id=t.sub,e.user.role=t.role,e.user.name=t.name,"update"===s&&(e.user.name=r.name),e),authorized({request:e,auth:r}){let{pathname:s}=e.nextUrl;if(!r&&[/\/shipping-address/,/\/payment-method/,/\/place-order/,/\/profile/,/\/user\/(.*)/,/\/order\/(.*)/,/\/admin/].some(e=>e.test(s)))return!1;if(e.cookies.get("sessionCartId"))return!0;{let r=crypto.randomUUID(),s=new Headers(e.headers),t=u.NextResponse.next({request:{headers:s}});return t.cookies.set("sessionCartId",r),t}}}},{handlers:p,auth:f,signIn:y,signOut:g}=(0,n.ZP)(m)},6669:(e,r,s)=>{s.d(r,{Ol:()=>o,SZ:()=>l,Zb:()=>n,aY:()=>c,ll:()=>d});var t=s(72051),a=s(26269),i=s(37170);let n=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...r}));n.displayName="Card";let o=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let d=a.forwardRef(({className:e,...r},s)=>t.jsx("h3",{ref:s,className:(0,i.cn)("font-semibold leading-none tracking-tight",e),...r}));d.displayName="CardTitle";let l=a.forwardRef(({className:e,...r},s)=>t.jsx("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let c=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent",a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},79306:(e,r,s)=>{s.d(r,{Z:()=>n});var t=s(39558),a=s(6355),i=s(49834);let n=(0,a.t)(i.i6,{schema:t})},39558:(e,r,s)=>{s.r(r),s.d(r,{accounts:()=>y,carts:()=>w,orderItems:()=>x,orderItemsRelations:()=>I,orders:()=>b,ordersRelations:()=>v,products:()=>N,sessions:()=>g,users:()=>f,verificationTokens:()=>h});var t=s(15049),a=s(74342),i=s(62428),n=s(19169),o=s(79492),d=s(40915),l=s(74722),c=s(23662),u=s(89221),m=s(5614),p=s(55519);let f=(0,a.af)("user",{id:(0,i.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").default("NO_NAME").notNull(),role:(0,n.fL)("role").notNull().default("user"),password:(0,n.fL)("password"),email:(0,n.fL)("email").notNull(),emailVerified:(0,o.AB)("emailVerified",{mode:"date"}),image:(0,n.fL)("image"),address:(0,d.AV)("address").$type(),paymentMethod:(0,n.fL)("paymentMethod")}),y=(0,a.af)("account",{userId:(0,i.Vj)("userId").notNull().references(()=>f.id,{onDelete:"cascade"}),type:(0,n.fL)("type").$type().notNull(),provider:(0,n.fL)("provider").notNull(),providerAccountId:(0,n.fL)("providerAccountId").notNull(),refresh_token:(0,n.fL)("refresh_token"),access_token:(0,n.fL)("access_token"),expires_at:(0,l._L)("expires_at"),token_type:(0,n.fL)("token_type"),scope:(0,n.fL)("scope"),id_token:(0,n.fL)("id_token"),session_state:(0,n.fL)("session_state")},e=>({compoundKey:(0,p.CK)({columns:[e.provider,e.providerAccountId]})})),g=(0,a.af)("session",{sessionToken:(0,n.fL)("sessionToken").primaryKey(),userId:(0,i.Vj)("userId").notNull().references(()=>f.id,{onDelete:"cascade"}),expires:(0,o.AB)("expires",{mode:"date"}).notNull()}),h=(0,a.af)("verificationToken",{identifier:(0,n.fL)("identifier").notNull(),token:(0,n.fL)("token").notNull(),expires:(0,o.AB)("expires",{mode:"date"}).notNull()},e=>({compoundKey:(0,p.CK)({columns:[e.identifier,e.token]})})),N=(0,a.af)("product",{id:(0,i.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),category:(0,n.fL)("category").notNull(),images:(0,n.fL)("images").array().notNull(),brand:(0,n.fL)("brand").notNull(),description:(0,n.fL)("description").notNull(),stock:(0,l._L)("stock").notNull(),price:(0,c.uR)("price",{precision:12,scale:2}).notNull().default("0"),rating:(0,c.uR)("rating",{precision:3,scale:2}).notNull().default("0"),numReviews:(0,l._L)("numReviews").notNull().default(0),isFeatured:(0,u.O7)("isFeatured").default(!1).notNull(),banner:(0,n.fL)("banner"),createdAt:(0,o.AB)("createdAt").defaultNow().notNull()},e=>({productSlugIdx:(0,m.o9)("product_slug_idx").on(e.slug)})),w=(0,a.af)("cart",{id:(0,i.Vj)("id").notNull().defaultRandom().primaryKey(),userId:(0,i.Vj)("userId").references(()=>f.id,{onDelete:"cascade"}),sessionCartId:(0,n.fL)("sessionCartId").notNull(),items:(0,d.AV)("items").$type().notNull().default([]),itemsPrice:(0,c.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,c.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,c.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,c.uR)("totalPrice",{precision:12,scale:2}).notNull(),createdAt:(0,o.AB)("createdAt").notNull().defaultNow()}),b=(0,a.af)("order",{id:(0,i.Vj)("id").defaultRandom().primaryKey(),userId:(0,i.Vj)("userId").notNull().references(()=>f.id,{onDelete:"cascade"}),shippingAddress:(0,d.AV)("shippingAddress").$type().notNull(),paymentMethod:(0,n.fL)("paymentMethod").notNull(),paymentResult:(0,d.AV)("paymentResult").$type(),itemsPrice:(0,c.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,c.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,c.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,c.uR)("totalPrice",{precision:12,scale:2}).notNull(),isPaid:(0,u.O7)("isPaid").notNull().default(!1),paidAt:(0,o.AB)("paidAt"),isDelivered:(0,u.O7)("isDelivered").notNull().default(!1),deliveredAt:(0,o.AB)("deliveredAt"),createdAt:(0,o.AB)("createdAt").notNull().defaultNow()}),v=(0,t.lE)(b,({one:e,many:r})=>({orderItems:r(x),user:e(f,{fields:[b.userId],references:[f.id]})})),x=(0,a.af)("orderItems",{orderId:(0,i.Vj)("orderId").notNull().references(()=>b.id,{onDelete:"cascade"}),productId:(0,i.Vj)("productId").notNull().references(()=>N.id,{onDelete:"cascade"}),qty:(0,l._L)("qty").notNull(),price:(0,c.uR)("price",{precision:12,scale:2}).notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),image:(0,n.fL)("image").notNull()},e=>({compoundKey:(0,p.CK)({columns:[e.orderId,e.productId]})})),I=(0,t.lE)(x,({one:e})=>({order:e(b,{fields:[x.orderId],references:[b.id]})}))},48185:(e,r,s)=>{s.r(r),s.d(r,{$$ACTION_0:()=>h,SignOut:()=>g,getUserById:()=>N,signInWithCredentials:()=>y,signUp:()=>f,updateUserAddress:()=>w,updateUserPaymentMethod:()=>b});var t=s(28713);s(9640);var a=s(22614),i=s(6352),n=s(12144),o=s(40461),d=s(79306),l=s(39558),c=s(70592),u=s(54068),m=s(80166),p=s(83557);async function f(e,r){try{let e=n.hV.parse({name:r.get("name"),email:r.get("email"),confirmPassword:r.get("confirmPassword"),password:r.get("password")}),s={id:crypto.randomUUID(),...e,password:(0,o.St)(e.password,10)};return await d.Z.insert(l.users).values(s),await (0,i.zB)("credentials",{email:e.email,password:e.password}),{success:!0,message:"User created successfully"}}catch(e){if((0,a.isRedirectError)(e))throw e;return{success:!1,message:(0,c.Z)(e).includes('duplicate key value violates unique constraint "user_email_idx"')?"Email is already exist":(0,c.Z)(e)}}}async function y(e,r){try{let e=n.aW.parse({email:r.get("email"),password:r.get("password")});return await (0,i.zB)("credentials",e),{success:!0,message:"Sig in successfully"}}catch(e){if((0,a.isRedirectError)(e))throw e;return{success:!1,message:"Invalid email or password"}}}let g=(0,t.j)("9894e6c57f99a2f4eccac4a43c9c453c2e8680a4",h);async function h(){await (0,i.w7)()}async function N(e){let r=await d.Z.query.users.findFirst({where:(r,{eq:s})=>s(r.id,e)});if(!r)throw Error("User not found");return r}async function w(e){try{let r=await (0,i.I8)(),s=await d.Z.query.users.findFirst({where:(e,{eq:s})=>s(e.id,r?.user.id)});if(!s)throw Error("User not found");let t=n.tV.parse(e);return await d.Z.update(l.users).set({address:t}).where((0,u.eq)(l.users.id,s.id)),(0,m.revalidatePath)("/place-order"),{success:!0,message:"User updated successfully"}}catch(e){return{success:!1,message:(0,c.Z)(e)}}}async function b(e){try{let r=await (0,i.I8)(),s=await d.Z.query.users.findFirst({where:(e,{eq:s})=>s(e.id,r?.user.id)});if(!s)throw Error("User not found");let t=n.LD.parse(e);return await d.Z.update(l.users).set({paymentMethod:t.type}).where((0,u.eq)(l.users.id,s.id)),{success:!0,message:"User updated successfully"}}catch(e){return{success:!1,message:(0,c.Z)(e)}}}(0,p.h)([f,y,g,N,w,b]),(0,t.j)("be840f0dc3afac8b8d0c6b02dc3328bacb294db1",f),(0,t.j)("c90075d8792b89f7584984a67b421aab69e556af",y),(0,t.j)("6f62a9caef1528e29ef4461e98a41e80f8b1eae5",g),(0,t.j)("4896ea1b4f1dace1ade49eb3651161dc0c4f102a",N),(0,t.j)("7ef6945e100c99ebbac8da6a81410b4410597f01",w),(0,t.j)("abc73778e07b95e9d8f15868fea7f03dbbca9e71",b)},70592:(e,r,s)=>{s.d(r,{Aj:()=>a,Xp:()=>i,Z:()=>t}),Intl.NumberFormat("en-US",{currency:"USD",style:"currency",minimumFractionDigits:2});let t=e=>"ZodError"===e.name?Object.keys(e.errors).map(r=>{let s=e.errors[r].message;return`${e.errors[r].path}: ${s}`}).join(". "):"ValidationError"===e.name?Object.keys(e.errors).map(r=>e.errors[r].message).join(". "):"string"==typeof e.message?e.message:JSON.stringify(e.message),a=e=>{let[r,s]=e.toString().split(".");return s?`${r}.${s.padEnd(2,"0")}`:r},i=e=>{if("number"==typeof e)return Math.round((e+Number.EPSILON)*100)/100;if("string"==typeof e)return Math.round((Number(e)+Number.EPSILON)*100)/100;throw Error("value is not a number nor a string")}},12144:(e,r,s)=>{s.d(r,{oU:()=>c,Mn:()=>p,LD:()=>m,tV:()=>u,aW:()=>d,hV:()=>l});var t=s(79176),a=s(13805),i=s(70592);let n=process.env.PAYMENT_METHODS?process.env.PAYMENT_METHODS.split(", "):["PayPal","Stripe"];process.env.DEFAULT_PAYMENT_METHOD;var o=s(39558);let d=t.Ry({email:t.Z_().email().min(3,"Email must be at least 3 characters"),password:t.Z_().min(3,"Password must be at least 3 characters")}),l=t.Ry({name:t.Z_().min(3,"Name must be at least 3 characters"),email:t.Z_().email().min(3,"Email must be at least 3 characters"),password:t.Z_().min(3,"Password must be at least 3 characters"),confirmPassword:t.Z_().min(3,"Confirm password must be at least 3 characters")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),c=t.Ry({productId:t.Z_().min(1,"Product is required"),name:t.Z_().min(1,"Name is required"),slug:t.Z_().min(1,"Slug is required"),qty:t.Rx().int().nonnegative("Quantity must be a non-negative number"),image:t.Z_().min(1,"Image is required"),price:t.Rx().refine(e=>/^\d+(\.\d{2})?$/.test((0,i.Aj)(e)),"Price must have exactly two decimal places (e.g., 49.99)")}),u=t.Ry({fullName:t.Z_().min(3,"Name must be at least 3 characters"),streetAddress:t.Z_().min(3,"Address must be at least 3 characters"),city:t.Z_().min(3,"city must be at least 3 characters"),postalCode:t.Z_().min(3,"Postal code must be at least 3 characters"),country:t.Z_().min(3,"Country must be at least 3 characters"),lat:t.Rx().optional(),lng:t.Rx().optional()}),m=t.Ry({type:t.Z_().min(1,"Payment method is required")}).refine(e=>n.includes(e.type),{path:["type"],message:"Invalid payment method"});t.Ry({id:t.Z_(),status:t.Z_(),email_address:t.Z_(),pricePaid:t.Z_()});let p=(0,a.fC)(o.orders,{shippingAddress:u,paymentResult:t.Ry({id:t.Z_(),status:t.Z_(),email_address:t.Z_(),pricePaid:t.Z_()}).optional()});(0,a.fC)(o.orderItems,{price:t.Rx()})}};