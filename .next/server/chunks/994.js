exports.id=994,exports.ids=[994],exports.modules={93739:()=>{},6047:(e,s,t)=>{"use strict";t.d(s,{DropdownMenu:()=>i,DropdownMenuContent:()=>u,DropdownMenuItem:()=>l,DropdownMenuLabel:()=>m,DropdownMenuTrigger:()=>c});var r=t(97247),a=t(28964),o=t(16921),n=t(2095),d=t(25008);let i=o.fC,c=o.xz;o.ZA,o.Uv,o.Tr,o.Ee,a.forwardRef(({className:e,inset:s,children:t,...a},i)=>(0,r.jsxs)(o.fF,{ref:i,className:(0,d.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",e),...a,children:[t,r.jsx(n.XCv,{className:"ml-auto h-4 w-4"})]})).displayName=o.fF.displayName,a.forwardRef(({className:e,...s},t)=>r.jsx(o.tu,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})).displayName=o.tu.displayName;let u=a.forwardRef(({className:e,sideOffset:s=4,...t},a)=>r.jsx(o.Uv,{children:r.jsx(o.VY,{ref:a,sideOffset:s,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));u.displayName=o.VY.displayName;let l=a.forwardRef(({className:e,inset:s,...t},a)=>r.jsx(o.ck,{ref:a,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",e),...t}));l.displayName=o.ck.displayName,a.forwardRef(({className:e,children:s,checked:t,...a},i)=>(0,r.jsxs)(o.oC,{ref:i,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(o.wU,{children:r.jsx(n.nQG,{className:"h-4 w-4"})})}),s]})).displayName=o.oC.displayName,a.forwardRef(({className:e,children:s,...t},a)=>(0,r.jsxs)(o.Rk,{ref:a,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(o.wU,{children:r.jsx(n.jXb,{className:"h-4 w-4 fill-current"})})}),s]})).displayName=o.Rk.displayName;let m=a.forwardRef(({className:e,inset:s,...t},a)=>r.jsx(o.__,{ref:a,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...t}));m.displayName=o.__.displayName,a.forwardRef(({className:e,...s},t)=>r.jsx(o.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=o.Z0.displayName},1779:(e,s,t)=>{"use strict";t.d(s,{I8:()=>p,handlers:()=>f,w7:()=>h,zB:()=>w});var r=t(78385),a=t(17198),o=t(29785),n=t(35872),d=t(35957),i=t(9396),c=t(53117),u=t(52845),l=t(71309);let m={pages:{signIn:"/sign-in",error:"/sign-in"},session:{strategy:"jwt",maxAge:2592e3},adapter:(0,r.J)(i.Z),providers:[(0,d.Z)({credentials:{email:{type:"email"},password:{type:"password"}},async authorize(e){if(null==e)return null;let s=await i.Z.query.users.findFirst({where:(0,o.eq)(c.users.email,e.email)});return s&&s.password&&(0,a.oH)(e.password,s.password)?{id:s.id,name:s.name,email:s.email,role:s.role}:null}})],callbacks:{jwt:async({token:e,user:s,trigger:t,session:r})=>{if(s&&("signIn"===t||"signUp"===t)){let e=u.cookies().get("sessionCartId")?.value;if(!e)throw Error("Session Cart Not Found");let t=await i.Z.query.carts.findFirst({where:(0,o.eq)(c.carts.sessionCartId,e)});if(t&&!t.userId){let r=await i.Z.query.carts.findFirst({where:(0,o.eq)(c.carts.userId,s.id)});r?((0,u.cookies)().set("beforeSigninSessionCartId",e),(0,u.cookies)().set("sessionCartId",r.sessionCartId)):i.Z.update(c.carts).set({userId:s.id}).where((0,o.eq)(c.carts.id,t.id))}}return r?.user.name&&"update"===t&&(e.name=r.user.name),e},session:async({session:e,user:s,trigger:t,token:r})=>(e.user.id=r.sub,e.user.role=r.role,e.user.name=r.name,"update"===t&&(e.user.name=s.name),e),authorized({request:e,auth:s}){let{pathname:t}=e.nextUrl;if(!s&&[/\/shipping-address/,/\/payment-method/,/\/place-order/,/\/profile/,/\/user\/(.*)/,/\/order\/(.*)/,/\/admin/].some(e=>e.test(t)))return!1;if(e.cookies.get("sessionCartId"))return!0;{let s=crypto.randomUUID(),t=new Headers(e.headers),r=l.NextResponse.next({request:{headers:t}});return r.cookies.set("sessionCartId",s),r}}}},{handlers:f,auth:p,signIn:w,signOut:h}=(0,n.ZP)(m)},24127:(e,s,t)=>{"use strict";t.d(s,{Z:()=>x});var r=t(72051),a=t(92349),o=t(1779),n=t(98300),d=t(45347);let i=(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenu`),c=(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuTrigger`),u=(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuContent`),l=(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuItem`);(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuCheckboxItem`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuRadioItem`);let m=(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuLabel`);(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuSeparator`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuShortcut`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuGroup`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuPortal`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuSub`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuSubContent`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuSubTrigger`),(0,d.createProxy)(String.raw`/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/components/ui/dropdown-menu.tsx#DropdownMenuRadioGroup`);var f=t(23829);async function p(){let e=await (0,o.I8)();return e?r.jsx("div",{className:"flex gap-2 items-center",children:(0,r.jsxs)(i,{children:[r.jsx(c,{asChild:!0,children:r.jsx("div",{className:"flex items-center",children:r.jsx(n.z,{variant:"ghost",className:"relative w-8 h-8 rounded-full ml-2",children:e.user.name})})}),(0,r.jsxs)(u,{className:"w-56",align:"end",forceMount:!0,children:[r.jsx(m,{className:"font-normal",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[r.jsx("p",{className:"text-sm font-medium leading-none",children:e.user.name}),r.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:e.user.email})]})}),r.jsx(l,{children:r.jsx(a.default,{className:"w-full",href:"/user/profile",children:"Profile"})}),r.jsx(l,{children:r.jsx(a.default,{className:"w-full",href:"/user/orders",children:"Order History"})}),r.jsx(l,{className:"p-0 mb-1",children:r.jsx("form",{action:f.SignOut,className:"w-full",children:r.jsx(n.z,{className:"w-full py-4 px-2 h-4 justify-start",variant:"ghost",children:"Sign Out"})})})]})]})}):r.jsx(a.default,{href:"/api/auth/signin",children:r.jsx(n.z,{children:"Sign In"})})}var w=t(28111),h=t(20353),y=t(6001);async function g(){let e=await (0,y.getMyCart)();return r.jsx(n.z,{asChild:!0,variant:"ghost",children:(0,r.jsxs)(a.default,{href:"/cart",children:[r.jsx(w.Z,{className:"mr-1"}),"Cart",e&&e.items.length>0&&r.jsx(h.C,{className:"ml-1",children:e.items.reduce((e,s)=>e+s.qty,0)})]})})}let x=()=>r.jsx(r.Fragment,{children:r.jsx("div",{className:"flex justify-end gap-3",children:(0,r.jsxs)("nav",{className:"md:flex hidden w-full max-w-xs gap-1",children:[r.jsx(g,{}),r.jsx(p,{})]})})})},20353:(e,s,t)=>{"use strict";t.d(s,{C:()=>d});var r=t(72051);t(26269);var a=t(45994),o=t(37170);let n=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:s,...t}){return r.jsx("div",{className:(0,o.cn)(n({variant:s}),e),...t})}},98300:(e,s,t)=>{"use strict";t.d(s,{z:()=>c});var r=t(72051),a=t(26269),o=t(96734),n=t(45994),d=t(37170);let i=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef(({className:e,variant:s,size:t,asChild:a=!1,...n},c)=>{let u=a?o.g7:"button";return r.jsx(u,{className:(0,d.cn)(i({variant:s,size:t,className:e})),ref:c,...n})});c.displayName="Button"},9396:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var r=t(53117),a=t(60713),o=t(52143);let n=(0,a.t)(o.i6,{schema:r})},53117:(e,s,t)=>{"use strict";t.r(s),t.d(s,{accounts:()=>w,carts:()=>x,orderItems:()=>v,orderItemsRelations:()=>I,orders:()=>b,ordersRelations:()=>N,products:()=>g,sessions:()=>h,users:()=>p,verificationTokens:()=>y});var r=t(28907),a=t(15308),o=t(59397),n=t(39411),d=t(70380),i=t(22344),c=t(46248),u=t(67691),l=t(21305),m=t(10950),f=t(14244);let p=(0,a.af)("user",{id:(0,o.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").default("NO_NAME").notNull(),role:(0,n.fL)("role").notNull().default("user"),password:(0,n.fL)("password"),email:(0,n.fL)("email").notNull(),emailVerified:(0,d.AB)("emailVerified",{mode:"date"}),image:(0,n.fL)("image"),address:(0,i.AV)("address").$type(),paymentMethod:(0,n.fL)("paymentMethod")}),w=(0,a.af)("account",{userId:(0,o.Vj)("userId").notNull().references(()=>p.id,{onDelete:"cascade"}),type:(0,n.fL)("type").$type().notNull(),provider:(0,n.fL)("provider").notNull(),providerAccountId:(0,n.fL)("providerAccountId").notNull(),refresh_token:(0,n.fL)("refresh_token"),access_token:(0,n.fL)("access_token"),expires_at:(0,c._L)("expires_at"),token_type:(0,n.fL)("token_type"),scope:(0,n.fL)("scope"),id_token:(0,n.fL)("id_token"),session_state:(0,n.fL)("session_state")},e=>({compoundKey:(0,f.CK)({columns:[e.provider,e.providerAccountId]})})),h=(0,a.af)("session",{sessionToken:(0,n.fL)("sessionToken").primaryKey(),userId:(0,o.Vj)("userId").notNull().references(()=>p.id,{onDelete:"cascade"}),expires:(0,d.AB)("expires",{mode:"date"}).notNull()}),y=(0,a.af)("verificationToken",{identifier:(0,n.fL)("identifier").notNull(),token:(0,n.fL)("token").notNull(),expires:(0,d.AB)("expires",{mode:"date"}).notNull()},e=>({compoundKey:(0,f.CK)({columns:[e.identifier,e.token]})})),g=(0,a.af)("product",{id:(0,o.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),category:(0,n.fL)("category").notNull(),images:(0,n.fL)("images").array().notNull(),brand:(0,n.fL)("brand").notNull(),description:(0,n.fL)("description").notNull(),stock:(0,c._L)("stock").notNull(),price:(0,u.uR)("price",{precision:12,scale:2}).notNull().default("0"),rating:(0,u.uR)("rating",{precision:3,scale:2}).notNull().default("0"),numReviews:(0,c._L)("numReviews").notNull().default(0),isFeatured:(0,l.O7)("isFeatured").default(!1).notNull(),banner:(0,n.fL)("banner"),createdAt:(0,d.AB)("createdAt").defaultNow().notNull()},e=>({productSlugIdx:(0,m.o9)("product_slug_idx").on(e.slug)})),x=(0,a.af)("cart",{id:(0,o.Vj)("id").notNull().defaultRandom().primaryKey(),userId:(0,o.Vj)("userId").references(()=>p.id,{onDelete:"cascade"}),sessionCartId:(0,n.fL)("sessionCartId").notNull(),items:(0,i.AV)("items").$type().notNull().default([]),itemsPrice:(0,u.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,u.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,u.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,u.uR)("totalPrice",{precision:12,scale:2}).notNull(),createdAt:(0,d.AB)("createdAt").notNull().defaultNow()}),b=(0,a.af)("order",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("userId").notNull().references(()=>p.id,{onDelete:"cascade"}),shippingAddress:(0,i.AV)("shippingAddress").$type().notNull(),paymentMethod:(0,n.fL)("paymentMethod").notNull(),paymentResult:(0,i.AV)("paymentResult").$type(),itemsPrice:(0,u.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,u.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,u.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,u.uR)("totalPrice",{precision:12,scale:2}).notNull(),isPaid:(0,l.O7)("isPaid").notNull().default(!1),paidAt:(0,d.AB)("paidAt"),isDelivered:(0,l.O7)("isDelivered").notNull().default(!1),deliveredAt:(0,d.AB)("deliveredAt"),createdAt:(0,d.AB)("createdAt").notNull().defaultNow()}),N=(0,r.lE)(b,({one:e,many:s})=>({orderItems:s(v),user:e(p,{fields:[b.userId],references:[p.id]})})),v=(0,a.af)("orderItems",{orderId:(0,o.Vj)("orderId").notNull().references(()=>b.id,{onDelete:"cascade"}),productId:(0,o.Vj)("productId").notNull().references(()=>g.id,{onDelete:"cascade"}),qty:(0,c._L)("qty").notNull(),price:(0,u.uR)("price",{precision:12,scale:2}).notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),image:(0,n.fL)("image").notNull()},e=>({compoundKey:(0,f.CK)({columns:[e.orderId,e.productId]})})),I=(0,r.lE)(v,({one:e})=>({order:e(b,{fields:[v.orderId],references:[b.id]})}))},6001:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$ACTION_0:()=>h,$$ACTION_1:()=>g,addItemToCart:()=>w,getMyCart:()=>f,removeItemFromCart:()=>y});var r=t(94214);t(84674);var a=t(1779),o=t(9396),n=t(53117),d=t(29785),i=t(52845),c=t(45315),u=t(37170),l=t(6778),m=t(54772);async function f(){let e=i.cookies().get("sessionCartId")?.value;if(!e)return;let s=await (0,a.I8)(),t=s?.user.id;return await o.Z.query.carts.findFirst({where:t?(0,d.eq)(n.carts.userId,t):(0,d.eq)(n.carts.sessionCartId,e)})}let p=e=>{let s=(0,u.Xp)(e.reduce((e,s)=>e+s.price*s.qty,0)),t=(0,u.Xp)(s>100?0:10),r=(0,u.Xp)(.15*s),a=(0,u.Xp)(s+t+r);return{itemsPrice:s.toFixed(2),shippingPrice:t.toFixed(2),taxPrice:r.toFixed(2),totalPrice:a.toFixed(2)}},w=(0,r.j)("d2d3db1dd1f5ae5ad5053f8ad3bc0f2da4d94473",h);async function h(e){try{let s=i.cookies().get("sessionCartId")?.value;if(!s)throw Error("Cart Session not found");let t=await (0,a.I8)(),r=t?.user.id,u=await f(),m=c.oU.parse(e),w=await o.Z.query.products.findFirst({where:(0,d.eq)(n.products.id,m.productId)});if(!w)throw Error("Product not found");if(u){let e=u.items.find(e=>e.productId===m.productId);if(e){if(w.stock<e.qty+1)throw Error("Not enough stock");u.items.find(e=>e.productId===m.productId).qty=e.qty+1}else{if(w.stock<1)throw Error("Not enough stock");u.items.push(m)}return await o.Z.update(n.carts).set({items:u.items,...p(u.items)}).where((0,d.xD)((0,d.eq)(n.carts.id,u.id))),(0,l.revalidatePath)(`/product/${w.slug}`),{success:!0,message:`${w.name} ${e?"updated in":"added to"} cart successfully`}}if(w.stock<1)throw Error("Not enough stock");return await o.Z.insert(n.carts).values({userId:r,items:[m],sessionCartId:s,...p([m])}),(0,l.revalidatePath)(`/product/${w.slug}`),{success:!0,message:"Item added to cart successfully"}}catch(e){return{success:!1,message:(0,u.Z)(e)}}}let y=(0,r.j)("9ca5872de79006ed19093a5fb9a9561bb840e13b",g);async function g(e){try{if(!i.cookies().get("sessionCartId")?.value)throw Error("Cart Session not found");let s=await o.Z.query.products.findFirst({where:(0,d.eq)(n.products.id,e)});if(!s)throw Error("Product not found");let t=await f();if(!t)throw Error("Cart not found");let r=t.items.find(s=>s.productId===e);if(!r)throw Error("Item not found");return 1===r.qty?t.items=t.items.filter(e=>e.productId!==r.productId):t.items.find(s=>s.productId===e).qty=r.qty-1,await o.Z.update(n.carts).set({items:t.items,...p(t.items)}).where((0,d.eq)(n.carts.id,t.id)),(0,l.revalidatePath)(`/product/${s.slug}`),{success:!0,message:`${s.name}  ${t.items.find(s=>s.productId===e)?"updated in":"removed from"} cart successfully`}}catch(e){return{success:!1,message:(0,u.Z)(e)}}}(0,m.h)([f,w,y]),(0,r.j)("fe554d431ad4dbdcf2b2dc0e821c8d0adcf5a00c",f),(0,r.j)("41fc677b184effcb0016e001cd930a9fb30ddb0a",w),(0,r.j)("d33ae3afc17ff86a896b65bbc01c77b3fd04f032",y)},23829:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$ACTION_0:()=>y,SignOut:()=>h,getUserById:()=>g,signInWithCredentials:()=>w,signUp:()=>p,updateProfile:()=>N,updateUserAddress:()=>x,updateUserPaymentMethod:()=>b});var r=t(94214);t(84674);var a=t(1192),o=t(1779),n=t(45315),d=t(17198),i=t(9396),c=t(53117),u=t(37170),l=t(29785),m=t(6778),f=t(54772);async function p(e,s){try{let e=n.hV.parse({name:s.get("name"),email:s.get("email"),confirmPassword:s.get("confirmPassword"),password:s.get("password")}),t={id:crypto.randomUUID(),...e,password:(0,d.St)(e.password,10)};return await i.Z.insert(c.users).values(t),await (0,o.zB)("credentials",{email:e.email,password:e.password}),{success:!0,message:"User created successfully"}}catch(e){if((0,a.isRedirectError)(e))throw e;return{success:!1,message:(0,u.Z)(e).includes('duplicate key value violates unique constraint "user_email_idx"')?"Email is already exist":(0,u.Z)(e)}}}async function w(e,s){try{let e=n.aW.parse({email:s.get("email"),password:s.get("password")});return await (0,o.zB)("credentials",e),{success:!0,message:"Sig in successfully"}}catch(e){if((0,a.isRedirectError)(e))throw e;return{success:!1,message:"Invalid email or password"}}}let h=(0,r.j)("9894e6c57f99a2f4eccac4a43c9c453c2e8680a4",y);async function y(){await (0,o.w7)()}async function g(e){let s=await i.Z.query.users.findFirst({where:(s,{eq:t})=>t(s.id,e)});if(!s)throw Error("User not found");return s}async function x(e){try{let s=await (0,o.I8)(),t=await i.Z.query.users.findFirst({where:(e,{eq:t})=>t(e.id,s?.user.id)});if(!t)throw Error("User not found");let r=n.tV.parse(e);return await i.Z.update(c.users).set({address:r}).where((0,l.eq)(c.users.id,t.id)),(0,m.revalidatePath)("/place-order"),{success:!0,message:"User updated successfully"}}catch(e){return{success:!1,message:(0,u.Z)(e)}}}async function b(e){try{let s=await (0,o.I8)(),t=await i.Z.query.users.findFirst({where:(e,{eq:t})=>t(e.id,s?.user.id)});if(!t)throw Error("User not found");let r=n.LD.parse(e);return await i.Z.update(c.users).set({paymentMethod:r.type}).where((0,l.eq)(c.users.id,t.id)),{success:!0,message:"User updated successfully"}}catch(e){return{success:!1,message:(0,u.Z)(e)}}}async function N(e){try{let s=await (0,o.I8)(),t=await i.Z.query.users.findFirst({where:(e,{eq:t})=>t(e.id,s?.user.id)});if(!t)throw Error("User not found");return await i.Z.update(c.users).set({name:e.name}).where((0,l.eq)(c.users.id,t.id)),{success:!0,message:"User updated successfully"}}catch(e){return{success:!1,message:(0,u.Z)(e)}}}(0,f.h)([p,w,h,g,x,b,N]),(0,r.j)("be840f0dc3afac8b8d0c6b02dc3328bacb294db1",p),(0,r.j)("c90075d8792b89f7584984a67b421aab69e556af",w),(0,r.j)("6f62a9caef1528e29ef4461e98a41e80f8b1eae5",h),(0,r.j)("4896ea1b4f1dace1ade49eb3651161dc0c4f102a",g),(0,r.j)("7ef6945e100c99ebbac8da6a81410b4410597f01",x),(0,r.j)("abc73778e07b95e9d8f15868fea7f03dbbca9e71",b),(0,r.j)("37248d5a5d92203bea071298526bbf56bd6a282e",N)},45315:(e,s,t)=>{"use strict";t.d(s,{LD:()=>m,Mn:()=>f,aW:()=>i,hV:()=>c,oU:()=>u,tV:()=>l});var r=t(11045),a=t(76954),o=t(37170),n=t(89112),d=t(53117);let i=r.Ry({email:r.Z_().email().min(3,"Email must be at least 3 characters"),password:r.Z_().min(3,"Password must be at least 3 characters")}),c=r.Ry({name:r.Z_().min(3,"Name must be at least 3 characters"),email:r.Z_().email().min(3,"Email must be at least 3 characters"),password:r.Z_().min(3,"Password must be at least 3 characters"),confirmPassword:r.Z_().min(3,"Confirm password must be at least 3 characters")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),u=r.Ry({productId:r.Z_().min(1,"Product is required"),name:r.Z_().min(1,"Name is required"),slug:r.Z_().min(1,"Slug is required"),qty:r.Rx().int().nonnegative("Quantity must be a non-negative number"),image:r.Z_().min(1,"Image is required"),price:r.Rx().refine(e=>/^\d+(\.\d{2})?$/.test((0,o.Aj)(e)),"Price must have exactly two decimal places (e.g., 49.99)")}),l=r.Ry({fullName:r.Z_().min(3,"Name must be at least 3 characters"),streetAddress:r.Z_().min(3,"Address must be at least 3 characters"),city:r.Z_().min(3,"city must be at least 3 characters"),postalCode:r.Z_().min(3,"Postal code must be at least 3 characters"),country:r.Z_().min(3,"Country must be at least 3 characters"),lat:r.Rx().optional(),lng:r.Rx().optional()}),m=r.Ry({type:r.Z_().min(1,"Payment method is required")}).refine(e=>n.LM.includes(e.type),{path:["type"],message:"Invalid payment method"});r.Ry({id:r.Z_(),status:r.Z_(),email_address:r.Z_(),pricePaid:r.Z_()});let f=(0,a.fC)(d.orders,{shippingAddress:l,paymentResult:r.Ry({id:r.Z_(),status:r.Z_(),email_address:r.Z_(),pricePaid:r.Z_()}).optional()});(0,a.fC)(d.orderItems,{price:r.Rx()}),r.Ry({name:r.Z_().min(3,"Name must be at least 3 characters"),email:r.Z_().email().min(3,"Email must be at least 3 characters")})}};