(()=>{var e={};e.id=912,e.ids=[912],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},93739:()=>{},52627:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>p,staticGenerationAsyncStorage:()=>c});var s={};r.r(s),r.d(s,{GET:()=>a,POST:()=>u});var i=r(73278),o=r(45002),n=r(54877);let{GET:a,POST:u}=r(1779).handlers,l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/Users/obadosunmu/Documents/newcommerce/chooselifeandpeace/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:p}=l,f="/api/auth/[...nextauth]/route";function m(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:c})}},1779:(e,t,r)=>{"use strict";r.d(t,{I8:()=>m,handlers:()=>f,w7:()=>x,zB:()=>N});var s=r(78385),i=r(17198),o=r(29785),n=r(35872),a=r(35957),u=r(9396),l=r(53117),d=r(52845),c=r(71309);let p={pages:{signIn:"/sign-in",error:"/sign-in"},session:{strategy:"jwt",maxAge:2592e3},adapter:(0,s.J)(u.Z),providers:[(0,a.Z)({credentials:{email:{type:"email"},password:{type:"password"}},async authorize(e){if(null==e)return null;let t=await u.Z.query.users.findFirst({where:(0,o.eq)(l.users.email,e.email)});return t&&t.password&&(0,i.oH)(e.password,t.password)?{id:t.id,name:t.name,email:t.email,role:t.role}:null}})],callbacks:{jwt:async({token:e,user:t,trigger:r,session:s})=>{if(t&&("signIn"===r||"signUp"===r)){let e=d.cookies().get("sessionCartId")?.value;if(!e)throw Error("Session Cart Not Found");let r=await u.Z.query.carts.findFirst({where:(0,o.eq)(l.carts.sessionCartId,e)});if(r&&!r.userId){let s=await u.Z.query.carts.findFirst({where:(0,o.eq)(l.carts.userId,t.id)});s?((0,d.cookies)().set("beforeSigninSessionCartId",e),(0,d.cookies)().set("sessionCartId",s.sessionCartId)):u.Z.update(l.carts).set({userId:t.id}).where((0,o.eq)(l.carts.id,r.id))}}return s?.user.name&&"update"===r&&(e.name=s.user.name),e},session:async({session:e,user:t,trigger:r,token:s})=>(e.user.id=s.sub,e.user.role=s.role,e.user.name=s.name,"update"===r&&(e.user.name=t.name),e),authorized({request:e,auth:t}){let{pathname:r}=e.nextUrl;if(!t&&[/\/shipping-address/,/\/payment-method/,/\/place-order/,/\/profile/,/\/user\/(.*)/,/\/order\/(.*)/,/\/admin/].some(e=>e.test(r)))return!1;if(e.cookies.get("sessionCartId"))return!0;{let t=crypto.randomUUID(),r=new Headers(e.headers),s=c.NextResponse.next({request:{headers:r}});return s.cookies.set("sessionCartId",t),s}}}},{handlers:f,auth:m,signIn:N,signOut:x}=(0,n.ZP)(p)},9396:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(53117),i=r(60713),o=r(52143);let n=(0,i.t)(o.i6,{schema:s})},53117:(e,t,r)=>{"use strict";r.r(t),r.d(t,{accounts:()=>N,carts:()=>g,orderItems:()=>L,orderItemsRelations:()=>A,orders:()=>I,ordersRelations:()=>q,products:()=>h,sessions:()=>x,users:()=>m,verificationTokens:()=>y});var s=r(28907),i=r(15308),o=r(59397),n=r(39411),a=r(70380),u=r(22344),l=r(46248),d=r(67691),c=r(21305),p=r(10950),f=r(14244);let m=(0,i.af)("user",{id:(0,o.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").default("NO_NAME").notNull(),role:(0,n.fL)("role").notNull().default("user"),password:(0,n.fL)("password"),email:(0,n.fL)("email").notNull(),emailVerified:(0,a.AB)("emailVerified",{mode:"date"}),image:(0,n.fL)("image"),address:(0,u.AV)("address").$type(),paymentMethod:(0,n.fL)("paymentMethod")}),N=(0,i.af)("account",{userId:(0,o.Vj)("userId").notNull().references(()=>m.id,{onDelete:"cascade"}),type:(0,n.fL)("type").$type().notNull(),provider:(0,n.fL)("provider").notNull(),providerAccountId:(0,n.fL)("providerAccountId").notNull(),refresh_token:(0,n.fL)("refresh_token"),access_token:(0,n.fL)("access_token"),expires_at:(0,l._L)("expires_at"),token_type:(0,n.fL)("token_type"),scope:(0,n.fL)("scope"),id_token:(0,n.fL)("id_token"),session_state:(0,n.fL)("session_state")},e=>({compoundKey:(0,f.CK)({columns:[e.provider,e.providerAccountId]})})),x=(0,i.af)("session",{sessionToken:(0,n.fL)("sessionToken").primaryKey(),userId:(0,o.Vj)("userId").notNull().references(()=>m.id,{onDelete:"cascade"}),expires:(0,a.AB)("expires",{mode:"date"}).notNull()}),y=(0,i.af)("verificationToken",{identifier:(0,n.fL)("identifier").notNull(),token:(0,n.fL)("token").notNull(),expires:(0,a.AB)("expires",{mode:"date"}).notNull()},e=>({compoundKey:(0,f.CK)({columns:[e.identifier,e.token]})})),h=(0,i.af)("product",{id:(0,o.Vj)("id").defaultRandom().primaryKey().notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),category:(0,n.fL)("category").notNull(),images:(0,n.fL)("images").array().notNull(),brand:(0,n.fL)("brand").notNull(),description:(0,n.fL)("description").notNull(),stock:(0,l._L)("stock").notNull(),price:(0,d.uR)("price",{precision:12,scale:2}).notNull().default("0"),rating:(0,d.uR)("rating",{precision:3,scale:2}).notNull().default("0"),numReviews:(0,l._L)("numReviews").notNull().default(0),isFeatured:(0,c.O7)("isFeatured").default(!1).notNull(),banner:(0,n.fL)("banner"),createdAt:(0,a.AB)("createdAt").defaultNow().notNull()},e=>({productSlugIdx:(0,p.o9)("product_slug_idx").on(e.slug)})),g=(0,i.af)("cart",{id:(0,o.Vj)("id").notNull().defaultRandom().primaryKey(),userId:(0,o.Vj)("userId").references(()=>m.id,{onDelete:"cascade"}),sessionCartId:(0,n.fL)("sessionCartId").notNull(),items:(0,u.AV)("items").$type().notNull().default([]),itemsPrice:(0,d.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,d.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,d.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,d.uR)("totalPrice",{precision:12,scale:2}).notNull(),createdAt:(0,a.AB)("createdAt").notNull().defaultNow()}),I=(0,i.af)("order",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("userId").notNull().references(()=>m.id,{onDelete:"cascade"}),shippingAddress:(0,u.AV)("shippingAddress").$type().notNull(),paymentMethod:(0,n.fL)("paymentMethod").notNull(),paymentResult:(0,u.AV)("paymentResult").$type(),itemsPrice:(0,d.uR)("itemsPrice",{precision:12,scale:2}).notNull(),shippingPrice:(0,d.uR)("shippingPrice",{precision:12,scale:2}).notNull(),taxPrice:(0,d.uR)("taxPrice",{precision:12,scale:2}).notNull(),totalPrice:(0,d.uR)("totalPrice",{precision:12,scale:2}).notNull(),isPaid:(0,c.O7)("isPaid").notNull().default(!1),paidAt:(0,a.AB)("paidAt"),isDelivered:(0,c.O7)("isDelivered").notNull().default(!1),deliveredAt:(0,a.AB)("deliveredAt"),createdAt:(0,a.AB)("createdAt").notNull().defaultNow()}),q=(0,s.lE)(I,({one:e,many:t})=>({orderItems:t(L),user:e(m,{fields:[I.userId],references:[m.id]})})),L=(0,i.af)("orderItems",{orderId:(0,o.Vj)("orderId").notNull().references(()=>I.id,{onDelete:"cascade"}),productId:(0,o.Vj)("productId").notNull().references(()=>h.id,{onDelete:"cascade"}),qty:(0,l._L)("qty").notNull(),price:(0,d.uR)("price",{precision:12,scale:2}).notNull(),name:(0,n.fL)("name").notNull(),slug:(0,n.fL)("slug").notNull(),image:(0,n.fL)("image").notNull()},e=>({compoundKey:(0,f.CK)({columns:[e.orderId,e.productId]})})),A=(0,s.lE)(L,({one:e})=>({order:e(I,{fields:[L.orderId],references:[I.id]})}))},73278:(e,t,r)=>{"use strict";e.exports=r(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[329,390],()=>r(52627));module.exports=s})();